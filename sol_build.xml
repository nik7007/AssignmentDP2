<?xml version="1.0" encoding="UTF-8"?>
<project name="WF-4_server_clients" basedir=".">

    <property name="lab4.location" location="${basedir}"/>
    <property name="lab4.location.sol" location="src/it/polito/dp2/WF/sol4"/>
    <property name="lab4.location.server" location="${lab4.location.sol}/server"/>
    <property name="lab4.location.client1" location="${lab4.location.sol}/client1"/>
    <property name="lab4.location.client2" location="${lab4.location.sol}/client2"/>

    <property name="WSDL" location="${basedir}/wsdl/Workflow.wsdl"/>


    <!-- The random "WorkflowMonitorFactory" used for WFInfo, for the server and for the tests -->
    <property name="WFInfo.WFMonitorFactory" value="it.polito.dp2.WF.Random.WorkflowMonitorFactoryImpl"/>

    <!-- The location to be used for class files -->
    <property name="build.dir" location="${lab4.location}/build"/>
    <!-- The location for source files -->
    <property name="src.dir" location="${lab4.location}/src"/>
    <!-- The location for jar files -->
    <property name="lib.dir" location="${lab4.location}/lib"/>

    <property name="gen.dir" location="${lab4.location}/gen4-src"/>

    <property name="package" value="it.polito.dp2.WF.lab4.gen"/>

    <property name="debug" value="true"/>
    <property name="debuglevel" value="source,lines,vars"/>
    <property name="target" value="1.7"/>
    <property name="source" value="1.7"/>

    <path id="sol.classpath">
        <pathelement location="${lib.dir}/WF.jar"/>
    </path>

    <target name="init">
        <mkdir dir="${build.dir}"/>
        <mkdir dir="${gen.dir}"/>
    </target>

    <target name="clean" description="Clean generated files and class files">
        <delete dir="${build.dir}"/>
        <delete dir="${gen.dir}"/>
    </target>

    <target name="compile-wsdl" depends="init">

        <echo message="${WSDL}"/>
        <exec executable="wsimport">
            <arg line="-d '${build.dir}' -p '${package}' -s '${gen.dir}' -keep ${WSDL}"/>
        </exec>

    </target>

    <target name="build-server" depends="init,compile-wsdl">
        <echo>- Building Server -</echo>
        <javac destdir="${build.dir}" debug="${debug}" debuglevel="${debuglevel}" source="${source}" target="${target}"
               includeantruntime="false">

            <src path="${src.dir}"/>
            <src path="${gen.dir}"/>
            <include name="it/polito/dp2/WF/sol4/server/**"/>
            <include name="it/polito/dp2/WF/lab4/server/*.java"/>
            <classpath>
                <path refid="sol.classpath"/>
            </classpath>

        </javac>

        <echo>- Done building Server -</echo>
    </target>

    <target name="build-client" depends="init,compile-wsdl">
        <echo>- Building Client 1, 2 and 3 -</echo>

        <javac destdir="${build.dir}" debug="${debug}" debuglevel="${debuglevel}" source="${source}" target="${target}"
               includeantruntime="false">

            <src path="${src.dir}"/>
            <src path="${gen.dir}"/>
            <include name="it/polito/dp2/WF/sol4/client1/**"/>
            <include name="it/polito/dp2/WF/lab4/client1/*.java"/>

            <include name="it/polito/dp2/WF/sol4/client2/**"/>
            <include name="it/polito/dp2/WF/lab4/client2/*.java"/>
        	
        	<include name="it/polito/dp2/WF/sol4/client3/**"/>
        	<include name="it/polito/dp2/WF/lab4/client3/*.java"/>
        	<!--<include name="it/polito/dp2/WF/lab4/**"/>
        	<include name="it/polito/dp2/WF/lab4/*.java"/>-->
        	<classpath>
        		<path refid="sol.classpath"/>
        	</classpath>

        </javac>


        <echo>- Done building Client 1, 2 and 3-</echo>
    </target>


</project>